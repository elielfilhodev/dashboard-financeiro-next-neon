"use strict";(()=>{var e={};e.id=892,e.ids=[892],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},25528:e=>{e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},91877:e=>{e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},25319:e=>{e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},39491:e=>{e.exports=require("assert")},14300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},82361:e=>{e.exports=require("events")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},63477:e=>{e.exports=require("querystring")},57310:e=>{e.exports=require("url")},73837:e=>{e.exports=require("util")},59796:e=>{e.exports=require("zlib")},12705:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>g,originalPathname:()=>v,patchFetch:()=>y,requestAsyncStorage:()=>h,routeModule:()=>d,serverHooks:()=>I,staticGenerationAsyncStorage:()=>x,staticGenerationBailout:()=>b});var n={};r.r(n),r.d(n,{GET:()=>m});var s=r(95419),o=r(69108),a=r(99678),i=r(78070),p=r(81355),u=r(3205),l=r(9108);function c(e){return["Janeiro","Fevereiro","Mar\xe7o","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"][e-1]||""}async function m(e){try{let e=await (0,p.getServerSession)(u.L);if(!e?.user?.id)return i.Z.json({error:"N\xe3o autorizado"},{status:401});let t=e.user.id,r=new Date;r.setMonth(r.getMonth()-6);let n=await l._.transaction.findMany({where:{userId:t,date:{gte:r}},select:{amount:!0,type:!0,date:!0}}),s={};n.forEach(e=>{let t=new Date(e.date).getMonth()+1,r=new Date(e.date).getFullYear(),n=`${r}-${t.toString().padStart(2,"0")}`;s[n]||(s[n]={income:0,expenses:0}),"INCOME"===e.type?s[n].income+=e.amount:s[n].expenses+=e.amount});let o=Object.entries(s).map(([e,t])=>{let[r,n]=e.split("-");return{month:`${c(parseInt(n))} ${r}`,income:t.income,expenses:t.expenses}}).sort((e,t)=>{let[r,n]=e.month.split(" "),[s,o]=t.month.split(" "),a=new Date(parseInt(r),"Janeiro"===c(parseInt(n))?0:"Fevereiro"===c(parseInt(n))?1:"Mar\xe7o"===c(parseInt(n))?2:"Abril"===c(parseInt(n))?3:"Maio"===c(parseInt(n))?4:"Junho"===c(parseInt(n))?5:"Julho"===c(parseInt(n))?6:"Agosto"===c(parseInt(n))?7:"Setembro"===c(parseInt(n))?8:"Outubro"===c(parseInt(n))?9:"Novembro"===c(parseInt(n))?10:11),i=new Date(parseInt(s),"Janeiro"===c(parseInt(o))?0:"Fevereiro"===c(parseInt(o))?1:"Mar\xe7o"===c(parseInt(o))?2:"Abril"===c(parseInt(o))?3:"Maio"===c(parseInt(o))?4:"Junho"===c(parseInt(o))?5:"Julho"===c(parseInt(o))?6:"Agosto"===c(parseInt(o))?7:"Setembro"===c(parseInt(o))?8:"Outubro"===c(parseInt(o))?9:"Novembro"===c(parseInt(o))?10:11);return a.getTime()-i.getTime()});return i.Z.json(o)}catch(e){return console.error("Erro ao buscar dados mensais:",e),i.Z.json({error:"Erro interno do servidor"},{status:500})}}let d=new s.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/monthly-income-expenses/route",pathname:"/api/monthly-income-expenses",filename:"route",bundlePath:"app/api/monthly-income-expenses/route"},resolvedPagePath:"C:\\Users\\Eliel Filho\\Documents\\codes\\dashboard-finance\\app\\api\\monthly-income-expenses\\route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:h,staticGenerationAsyncStorage:x,serverHooks:I,headerHooks:g,staticGenerationBailout:b}=d,v="/api/monthly-income-expenses/route";function y(){return(0,a.patchFetch)({serverHooks:I,staticGenerationAsyncStorage:x})}},3205:(e,t,r)=>{r.d(t,{L:()=>i});var n=r(54896),s=r(10375),o=r(86485),a=r(9108);let i={adapter:(0,n.N)(a._),providers:[(0,o.Z)({name:"credentials",credentials:{email:{label:"Email",type:"email"},password:{label:"Password",type:"password"}},async authorize(e){if(!e?.email)return null;let t=await a._.user.findUnique({where:{email:e.email}});return t?{id:t.id,email:t.email,name:t.name}:null}}),...process.env.GOOGLE_CLIENT_ID&&process.env.GOOGLE_CLIENT_SECRET?[(0,s.Z)({clientId:process.env.GOOGLE_CLIENT_ID,clientSecret:process.env.GOOGLE_CLIENT_SECRET})]:[]],session:{strategy:"jwt"},secret:process.env.NEXTAUTH_SECRET,pages:{signIn:"/auth/signin"},callbacks:{jwt:async({token:e,user:t})=>(t&&(e.id=t.id),e),session:async({session:e,token:t})=>(t&&(e.user.id=t.id),e)}}},9108:(e,t,r)=>{r.d(t,{_:()=>s});let n=require("@prisma/client"),s=globalThis.prisma??new n.PrismaClient}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[225,898,206],()=>r(12705));module.exports=n})();